package com.gnews.fake;

import java.io.ByteArrayInputStream;
import java.io.ObjectInputStream;

// HIGH severity: unsafe deserialization of untrusted data
public class VulnerabilityHigh {
    // Deserializes raw bytes without validation. This pattern enables remote code
    // execution when untrusted, crafted serialized objects are provided.
    // WARNING: Do not use in production. This method is intentionally unsafe for demonstration.
    public Object unsafeDeserialize(byte[] data) throws Exception {
        ByteArrayInputStream bais = new ByteArrayInputStream(data);
        ObjectInputStream ois = new ObjectInputStream(bais);
        Object obj = ois.readObject();
        // No validation, no allow-listing, potentially dangerous
        return obj;
    }
}
